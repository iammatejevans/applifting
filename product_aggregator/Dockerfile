FROM python:3.9-rc
COPY . /app
WORKDIR /app
RUN apt-get update && apt-get -y install cron && apt-get install python
RUN pip install -r requirements.txt
ENV BASE_URL=https://applifting-python-excercise-ms.herokuapp.com/api/v1
RUN python manage.py makemigrations
RUN python manage.py migrate
RUN python manage.py init_admin

# cron attempt - it works locally tho :'(
ADD crontab /etc/cron.d/simple-cron
RUN chmod 0644 /etc/cron.d/simple-cron

# Second attempt, this time using django-crontab
CMD service cron start
CMD python manage.py crontab add

CMD python manage.py runserver 0.0.0.0:8000
